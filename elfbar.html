<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PH OFICIAL - ELFBAR</title>
    <link rel="stylesheet" href="styleelfbar.css" />
  </head>
  <body>
    <!-- Logo Centralizada -->
    <div class="logo">
      <img id="phlogo" src="./Assets/phlogo.png" alt="Logo PH" />
    </div>

    <!-- Título da Página -->
    <h1 class="page-title">Sabores Disponíveis - ELFBAR</h1>

    <!-- Lista de Produtos Dinâmica -->
    <div class="product-container" id="product-container"></div>

    <!-- Botão WhatsApp -->
    <a
      href="https://wa.me/+5561984160056"
      class="whatsapp-button"
      target="_blank"
    >
      <img src="./Assets/whatsapp-icon.png" alt="WhatsApp" />
    </a>

    <!-- Script para puxar dados do Google Sheets -->
    <script>
      const sheetURL =
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vQG7xPPn-bd5_AUSvYfywduL3bquyp1PyshYGCjkIsNejft-8CmLeECG5Ih2s-zodDGctv9glmS19jd/pub?output=csv";

      async function fetchProducts() {
        const response = await fetch(sheetURL);
        const data = await response.text();
        const rows = data.split("\n").slice(1); // remove cabeçalho

        const container = document.getElementById("product-container");
        container.innerHTML = "";

        const produtosPorNome = {};

        rows.forEach((row) => {
          const [marca, produto, preco, imagem, sabor] = row.split(",");

          if (marca.trim().toUpperCase() === "ELFBAR") {
            const key = produto + preco + imagem;

            if (!produtosPorNome[key]) {
              produtosPorNome[key] = {
                nome: produto,
                preco: preco,
                imagem: imagem,
                sabores: [],
              };
            }

            if (sabor && !produtosPorNome[key].sabores.includes(sabor.trim())) {
              produtosPorNome[key].sabores.push(sabor.trim());
            }
          }
        });

        Object.values(produtosPorNome).forEach((produto) => {
          const card = document.createElement("div");
          card.className = "product-card";

          card.innerHTML = `
            <img src="${produto.imagem}" alt="${produto.nome}" />
            <div class="product-info">
              <h2>${produto.nome} - R$${produto.preco}</h2>
              <ul>
                ${produto.sabores.map((s) => `<li>${s}</li>`).join("")}
              </ul>
            </div>
          `;

          container.appendChild(card);
        });
      }

      fetchProducts();
    </script>
  </body>
</html>
